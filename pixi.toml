[workspace]
authors = ["rymskip <17lochinskij@protonmail.com>"]
channels = ["conda-forge"]
name = "macroforge"
platforms = ["osx-64"]
version = "0.1.0"

[tasks]
build = { cmd = "pixi run build:rust && pixi run build:plugin" }
"build:rust" = { cmd = "cd crates/macroforge_ts && bun x napi build --platform --release" }
"build:website" = {cmd = "cd website && npm run build"}
"build:plugin" = { cmd = "bun run --cwd packages/vite-plugin build" }
"build:@playground/macro" = { cmd = "cd playground/macro && bun x napi build --platform --release -p playground-macros" }
"build:@playground/svelte" = "cd playground/svelte && npm run build"
"build:@playground/vanilla" = "cd playground/vanilla && npm run build"
"build:playground" = "pixi run build:@playground/macro && pixi run build:@playground/svelte && pixi run build:@playground/vanilla"
"test:rust" = { cmd = "cd crates && cargo test --workspace" }
"test:packages" = { cmd = "cd packages/typescript-plugin && bun run test && cd ../svelte-language-server && bun run test && cd ../vite-plugin && bun run test" }
"test:playground" = { cmd = "node ./scripts/test-playground-expansion.cjs && (cd playground/tests && node --test --test-force-exit *.test.mjs) && (cd playground/tests && bun test validators/) && (cd playground/tests/rust-tests && cargo test) && (cd playground/tests && npm run test:e2e)" }
"test:all" = { cmd = "pixi run test:rust && pixi run test:packages && pixi run test:playground" }
"test:e2e:zed" = { cmd = "./tests/e2e/run-zed-test.sh" }
"test:e2e:zed:verbose" = { cmd = "./tests/e2e/run-zed-test.sh --verbose" }
"test:e2e:zed:node" = { cmd = "node --test tests/e2e/zed-extension-startup.test.js" }
diagnostics = { cmd = "bun ./scripts/diagnostics.cjs" }
"diagnostics:log" = { cmd = "bun ./scripts/diagnostics.cjs --log" }
"macro:expand" = { cmd = "cargo run -p ts_macro_cli -- expand --use-node" }
"macro:tsc" = { cmd = "cargo run -p ts_macro_cli -- tsc" }
"expand:playground" = { cmd = "bun ./scripts/expand-playground.cjs" }
"test:playground:expansion" = { cmd = "node ./scripts/test-playground-expansion.cjs" }
"cleanbuild:all" = { cmd = "bun ./scripts/cleanbuild-all.cjs" }
bump = { cmd = "node scripts/bump-version.cjs" }
"docs:book" = { cmd = "rust-script scripts/build-docs-book.rs" }
"docs:mcp" = { cmd = "rust-script packages/mcp-server/scripts/extract-docs.rs" }
"docs:api" = { cmd = "rust-script scripts/extract-rust-docs.rs && rust-script scripts/extract-ts-docs.rs" }
"docs:readmes" = { cmd = "node scripts/generate-readmes.cjs" }
"docs:all" = { cmd = "pixi run docs:api && pixi run docs:readmes && pixi run docs:book && pixi run docs:mcp" }
"docs:check" = { cmd = "node scripts/check-docs-freshness.cjs" }
prep = {cmd = "node scripts/prep-for-commit.cjs"}
"sync:website" = {cmd = "node scripts/sync-website.cjs"}

[dependencies]
